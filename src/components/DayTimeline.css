/* src/components/DayTimeline.css */

/* ===== Управляем сдвигом влево через переменные ===== */
:root{
  --tl-time-w: 30px;         /* колонка времени — уже → всё левее */
  --tl-pin-w: 46px;          /* колонка с кружком */
  --tl-check-w: 30px;
  --tl-gap: 10px;

  --tl-card-radius: 14px;
  --tl-pin-size: 44px;

  /* цвета (можно переопределить темой Telegram) */
  --tl-surface: var(--tg-bg);
  --tl-border: rgba(255,255,255,.16);
  --tl-border-soft: rgba(255,255,255,.12);
  --tl-text-dim: rgba(255,255,255,.78);
  --tl-text-faint: rgba(255,255,255,.62);

  --tl-line-solid: rgba(255,255,255,.42);
  --tl-line-dash:  rgba(255,255,255,.22);
  --tl-line-clear: 4px;     /* отступ линии от края круга */
  --tl-line-w: 2px;       /* толщина соединителя, можно 3px */
  --tl-row-vpad: 10px; /* вертикальный паддинг строки */
}

.tl{ max-width: 880px; margin: 0 auto; padding: 0 4px 24px; }
.tl-wrap{ position: relative; margin-top: 2px; }

.tl-list{ list-style: none; margin: 0; padding: 0; }
.tl-empty{ padding: 16px 8px; opacity: .7; text-align: center; }

/* Строка: [время] [пин] [карточка] [чек] */
.tl-row, .tl-gap-row{
  display: grid;
  grid-template-columns: var(--tl-time-w) var(--tl-pin-w) 1fr var(--tl-check-w);
  gap: var(--tl-gap);
  align-items: stretch;
  padding: var(--tl-row-vpad) 0;  /* ⬅️ через переменную */
  position: relative;
  min-height: calc(var(--tl-pin-size) + 12px);
}

/* Время — одна колонка одной высоты с кругом, чтобы совпадать по вертикали */
.tl-time{
  align-self: center;                 /* центрируем «блок времени» в строке */
  min-height: var(--tl-pin-size);     /* высота = диаметр круга */
  display: flex;
  flex-direction: column;
  align-items: flex-start;            /* слева, «вплотную» */
  padding-left: 0;                    /* без внутренних отступов */
  text-align: left;                   /* слева */
  line-height: 1.1;
  font-size: 12px;
  color: var(--tl-text-dim);
}

/* Одно время — по центру уровня круга */
.tl-time--single{ justify-content: center; }

/* Интервал — разнесём по верхнему/нижнему краю блока времени */
.tl-time--range{ justify-content: space-between; }

/* нижнее время у интервала — лишний зазор не нужен */
.tl-time--range .tl-time-bottom{ margin-top: 0; }

/* если где-то остался margin — нейтрализуем на всякий случай */
.tl-time-bottom{ margin-top: 0; color: var(--tl-text-faint); }

/* Кружок задачи */
.tl-pin{
  position: relative;
  display: flex;
  align-items: center;  /* центрируем круг внутри растянутой колонки */
  justify-content: center;
  z-index: 2;
}
.tl-pin-circle{
  width: var(--tl-pin-size); height: var(--tl-pin-size);
  border-radius: 50%;
  background: var(--tl-surface);
  display: grid; place-items: center;
  font-weight: 700; color: var(--tl-text-dim);
  box-shadow:
    0 0 0 10px rgba(255,255,255,.06) inset,
    0 0 0 1px rgba(255,255,255,.25);
}

/* ===== Соединители (вертикальные линии) рисуем у каждого пина ===== */
.tl-row .tl-pin::before,
.tl-row .tl-pin::after,
.tl-gap-row .tl-pin::before{
  content: "";
  position: absolute;
  left: calc(50% - var(--tl-line-w)/2);  /* было calc(50% - 1px) */
  width: var(--tl-line-w);               /* было 2px */
  z-index: 1;
  background: transparent;
}

/* ВЕРХ — спускаемся до верхнего паддинга предыдущей строки */
.tl-row[data-prev-conn="solid"] .tl-pin::before,
.tl-row[data-prev-conn="dashed"] .tl-pin::before{
  top: calc(-1 * var(--tl-row-vpad)); /* ⬅️ выходим выше строки */
  height: calc(
    50% - var(--tl-pin-size)/2 - var(--tl-line-clear) + var(--tl-row-vpad)
  );
}
.tl-row[data-prev-conn="solid"]  .tl-pin::before{ background: var(--tl-line-solid); }
.tl-row[data-prev-conn="dashed"] .tl-pin::before{
  background-image: repeating-linear-gradient(
    to bottom, var(--tl-line-dash) 0 8px, transparent 8px 16px
  );
}
.tl-row[data-prev-conn="none"]   .tl-pin::before{ display:none; }

/* НИЗ — дотягиваемся до нижнего паддинга текущей строки */
.tl-row[data-next-conn="solid"] .tl-pin::after,
.tl-row[data-next-conn="dashed"] .tl-pin::after{
  top: calc(50% + var(--tl-pin-size)/2 + var(--tl-line-clear));
  height: calc(
    50% - var(--tl-pin-size)/2 - var(--tl-line-clear) + var(--tl-row-vpad)
  );
}
.tl-row[data-next-conn="solid"]  .tl-pin::after{ background: var(--tl-line-solid); }
.tl-row[data-next-conn="dashed"] .tl-pin::after{
  background-image: repeating-linear-gradient(
    to bottom, var(--tl-line-dash) 0 8px, transparent 8px 16px
  );
}
.tl-row[data-next-conn="none"]   .tl-pin::after{ display:none; }

/* GAP-строка — пунктир через всю её высоту */
.tl-gap-row .tl-pin::before{
  top: calc(-1 * var(--tl-row-vpad));                   /* ⬅️ выше строки */
  height: calc(100% + 2 * var(--tl-row-vpad));         /* ⬅️ и ниже строки */
  background-image: repeating-linear-gradient(
    to bottom, var(--tl-line-dash) 0 8px, transparent 8px 16px
  );
}
.tl-gap-row .tl-pin::after{ display:none; }

/* Для GAP вместо кружка — маленькая точка */
.tl-gap-dot::before{
  content:"";
  width: 10px; height: 10px; border-radius: 50%;
  background: var(--tl-text-faint);
  display: block;
}

/* Карточки */
.tl-card{
  border: 1px solid var(--tl-border);
  border-radius: var(--tl-card-radius);
  padding: 12px 14px;
}
.tl-meta{ font-size: 12px; color: var(--tl-text-faint); margin-bottom: 4px; }
.tl-title{ font-size: 16px; font-weight: 700; }
.tl-from{ margin-top: 6px; font-size: 12px; color: var(--tl-text-faint); }

/* Правый чек */
.tl-check{
  width: 22px; height: 22px; border-radius: 50%;
  border: 1.5px solid var(--tl-border);
  justify-self: center;
}
.tl-check-hidden{ visibility: hidden; }

/* ===== Блок «на весь день» — без линий между ними ===== */
.tl-divider{ height: 1px; background: var(--tl-border); margin: 18px 0 8px; }
.tl-all-day-title{
  font-size: 12px; letter-spacing: .06em; text-transform: uppercase;
  color: var(--tl-text-dim); margin: 0 0 8px calc(var(--tl-time-w));
}

.tl-allday-list{ list-style: none; margin: 0; padding: 0; }
.tl-allday-row{
  display: grid;
  grid-template-columns: var(--tl-time-w) var(--tl-pin-w) 1fr var(--tl-check-w);
  gap: var(--tl-gap);
  align-items: center;
  padding: 8px 0;
}
.tl-ad-time{ text-align: right; font-size: 12px; color: var(--tl-text-faint); }
.tl-ad-pin{ display: flex; justify-content: center; align-items: center; }
.tl-ad-circle{
  width: var(--tl-pin-size); height: var(--tl-pin-size); border-radius: 50%;
  background: var(--tl-surface);
  display: grid; place-items: center;
  font-weight: 700; color: var(--tl-text-dim);
  box-shadow:
    0 0 0 10px rgba(255,255,255,.06) inset,
    0 0 0 1px rgba(255,255,255,.25);
}
.tl-ad-card{ border: 1px solid var(--tl-border); border-radius: var(--tl-card-radius); padding: 12px 14px; }

/* Адаптив: узкие экраны */
@media (max-width: 420px){
  :root{
    --tl-time-w: 40px;
    --tl-pin-w: 48px;
    --tl-check-w: 28px;
  }
  .tl-title{ font-size: 15px; }
}